parameters:
- name: Environment
  type: string
  default: "EnvironmentName"
# - name: VariableGroup
#   type: string
#   default: "VariableGroup"
- name: project_name
  type: string
  default: "project_name"

# pool:
#   name: "Hosted Ubuntu 1604"
steps:
- task: UsePythonVersion@0
  displayName: 'Use Python 3.7'
  inputs:
    versionSpec: 3.7
# Install required Python modules.
- task: CmdLine@2 
  displayName: 'Load Python Dependencies'
  inputs:
    script: pip3 install databricks-cli
- task: CmdLine@2
  displayName: 'Configure databricks cli'
  inputs: 
    script: |
      databricks configure --token <<EOF
      https://adb-1171646850907998.18.azuredatabricks.net/
      dapi493ff0e96c95ea876cbd8d799ec4c30d-2
      EOF
- task: CmdLine@2
  displayName: 'Export Databricks Workspace'
  inputs: 
    script: |
      databricks workspace import_dir $(Pipeline.Workspace)/s/databricks/${{parameters.project_name}} /${{parameters.Environment}}/${{parameters.project_name}} -o